不管是SharedPreferences，还是Room/SQLite，它们都为本地数据持久化提供了行之有效的途径。然而新的问题也随之出现了，如果要保存的数据是图片，或是一大段极长的文字，甚至是一段音视频，单单用SharedPreferences或Room/SQLite就会让开发者感到十分为难。

因为把这类数据往往体积较大，把它们转化成二进制之后再以键值对之类的形式进行存储显然是不合适的，尤其是进行大数据量的下载任务时，SharedPreferences或Room/SQLite更是无法胜任。因此在这种情况下，IO就派上用场了。

## 基本概念

### 什么是IO

IO是指Input/Output，即输入和输出。IO以内存为中心：

+ Input指**从外部读入数据到内存**，例如，把文件从磁盘读取到内存，从网络读取数据到内存等等。

+ Output指**把数据从内存输出到外部**，例如，把数据从内存写入到文件，把数据从内存输出到网络等等。

IO流是一种顺序读写数据的模式，它的特点是单向流动。IO流以byte（字节）为最小单位，因此也称为字节流。如果需要读写的是字符，并且字符不全是单字节表示的ASCII字符，那么，按照char来读写显然更方便，这种流称为字符流。

IO功能由Java的`java.io`包提供API支持。

### 存储空间

Android将设备的存储空间划分为内部存储空间和外部存储空间。

+ **内部存储空间**

内部存储空间（internal storage）是手机ROM当中的一块存储区域，主要用于<font color=red>存储应用程序的数据</font>。它跟“内存”（RAM，memory）不是同一个东西，不能混淆。

在Android系统中，内部存储空间对应的是`data/data/package_name`，它是一个属于应用程序的私有目录，系统通常不会允许其他应用访问，但是可以通过Android Studio的Device File Explorer来查看。此外，从Android 10开始，系统会对这些私有目录实施加密，以确保只有对应的应用程序在不用申请任何权限的情况下访问里面的数据。

当应用程序被卸载，对应的内部存储空间目录也会跟着被删除，里面的数据也随之被清除掉。因此，如果不希望某些数据在应用卸载的时候跟着被清除，那就不要把它们保存在内部存储空间的目录下面。

+ **外部存储空间**

外部存储空间（external storage）是跟内部存储空间相对应的一个概念，它可以被各种应用程序和用户访问，里面的数据也不会随着应用程序卸载而被清除。在Android 4.4以前，外部存储空间专指SD卡，但随着机身存储容量的提升，除内部存储空间以外的部分也被称为外部存储空间。<font color=red>这里仅讨论机身存储部分的外部存储空间</font>。

外部存储空间又分为外部私有存储和外部公共存储，前者对应的目录是`/storage/emulated/0/Android/data/package_name`，和内部存储空间相似，后者对应的就是前者以外的目录。

>外部私有存储

外部私有存储和内部存储有些类似，除了对应程序不用申请权限即可访问、数据会跟着应用卸载一同被清除之外，它还有两个特点：1） 只有在应用中调用API访问外部私有存储目录时，才会创建以package_name命名的私有存储目录；2）Android 7.0之前，其他应用程序可以采用`file://`格式的Uri直接访问某个程序的外部私有存储目录下的数据，Android 7.0之后就必须使用FileProvider。

>外部公共存储

外部公共存储主要存放和应用无关的数据，这些数据在卸载App的时候不会被删除。它还具有这些特点：1）应用要申请外部存储权限才能访问，在Android 6.0以后，外部存储权限还要动态申请；2）任何应用只要有外部存储权限，都可以访问公共存储目录下的数据。

综上，各种存储空间之间的关系可以用下图来概括：

![](pics/storage.png)

## 基本使用

### 访问内部存储空间的数据文件

### 访问外部存储空间的数据文件