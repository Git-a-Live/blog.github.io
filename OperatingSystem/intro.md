## 何为操作系统

操作系统（Operating System，OS）发展至今，还没办法给出一个准确的定义。想要理解操作系统到底是什么，往往需要从以下两个角度入手：

+ **<font color=red>向应用程序提供基本的抽象</font>**
+ **<font color=red>对计算机硬件进行资源管理</font>**

第一个角度是一种**自顶向下**的观点。通常情况下，在一个极其复杂的计算机设备上，应用程序很少会跟硬件直接打交道，因为硬件提供的接口往往是复杂和不一致的，一个应用程序想要适配成千上万种不同的硬件接口，显然是一种不可能的任务。因此在应用程序和硬件之间，必须存在一个充当“中间人”的角色，**隐藏底层硬件细节，为应用程序提供良好、清晰、优雅以及一致的抽象（比如系统API）**，这个角色就是操作系统。

第二种角度是一种**自底向上**的观点。从这个角度来说，操作系统的主要任务是**记录哪些应用程序在使用什么资源，对资源请求进行分配，评估使用代价，并为不同的应用程序和用户调解互相冲突的资源请求**。操作系统的资源管理往往采用<font color=red>时间复用</font>和<font color=red>空间复用</font>两种方式，来实现资源的多路复用（共享）。时间复用是指一项资源由不同的程序和用户轮流使用（比如CPU执行指令），空间复用则是指不同的程序和用户得到资源的一部分，从而不用进行排队等待（比如内存中有多个程序在运行）。

## 操作系统中的基本概念

### 进程

进程（process）在本质上是一个**正在执行的程序**，也可以说是**容纳运行一个程序所需的全部信息的容器**。在许多操作系统中，还会维护一张记录有每个进程所有信息（地址空间除外）的**进程表**，这个表的数据结构是数组或链表。

系统管理器会为每一个被启动的程序赋予一个UID（User Identification）供程序使用，如果一个进程还创建了子进程，那么它们的UID是相同的。每个用户可以是某个组的成员，因此还会被赋予GID（Group Identification）。

### 地址空间

地址空间（address space）是一个集合（或列表），里面包含有从某个最小值到某个最大值的存储位置。在特定的地址空间中，程序可以进行读写，因此一个地址空间里面可能存放有可执行的程序、程序相关的数据以及程序堆栈等。地址空间同时也是一个逻辑概念，因为它可能涉及到内存和硬盘两种不同性质的物理存储空间。换言之，地址空间的总大小可能小于，也可能大于内存或硬盘中的任意一个。

### 文件

文件（file）是操作系统中一个极为重要的概念，它是对**存储当中特定格式的数据集合体**的一种高度抽象。这种抽象模型独立于任何硬件设备，操作系统能够隐藏硬盘以及其他I/O设备的细节特性，文件的抽象无疑是十分关键的一点。在访问文件时，如果用户具备访问权限，文件会返回一个被称作**文件描述符**（file descriptor）的小整数以供后续使用，否则系统会返回一个错误码。

#### 目录

目录（directory）是一个和文件紧密相关的概念，主要用于文件的分类保存。目前绝大多数操作系统都支持目录的概念。目录具有层次结构，它可以包含文件和其他的目录，这就构成了文件系统。目录层结构中的每一个文件，都可以通过从目录顶部的**根目录**（root directory）开始的**路径名**（path name）来确定。如果一个路径名是从根目录开始的，那么就称其为**绝对路径**，否则称为**相对路径**。

#### 安装文件系统

安装文件系统是UNIX系统中一个重要概念，其核心操作就是将可移动介质（如U盘）的文件系统接到**主文件树**上。可移动介质的文件系统通过`mount`这一系统调用方式，接入到计算机的**根文件系统**，这样就建立起从计算机根目录到可移动介质文件的访问路径。

#### 特殊文件

特殊文件（special file）是UNIX当中另一个重要概念。特殊文件往往保存在`/dev`目录中，由此可知，特殊文件跟I/O设备之间具有密切关系。事实上，特殊文件的作用就是让I/O设备看起来跟一般意义上的文件一样，能够被操作系统以相同的调用方式读写。

特殊文件被分为**块特殊文件**（block special file）和**字符特殊文件**（character special file）两种类型。前者是指<font color=red>由可随机存取的块所组成</font>的设备，比如磁盘等，程序在访问块数据时，可以不用考虑存放该文件的文件系统结构；后者用于打印机、调制解调器以及其他<font color=blue>接收或输出字符流</font>的设备。

#### 管道

管道（pipe）是一种虚文件，用于连接两个进程实施通信。如果两个进程希望通过管道进行通信，那么就必须要提前设置管道。数据发送一方需要将数据写入管道，数据接收方则需要读取管道。这样，通信双方之间的交互就类似于普通文件的读写了。

## 操作系统结构

### 单体系统

### 层次式系统

### 微内核

### C/S模式

### 虚拟机

### 外核